(()=>{"use strict";let e=!1;class t{constructor({selector:e,pattern:t,method:n}){this.form=document.querySelector(e),this.pattern=t,this.method=n,this.elementsForm=[...this.form.elements].filter((e=>"button"!==e.tagName.toLowerCase()&&"button"!==e.type&&"hidden"!==e.type)),this.error=new Set}init(){this.applyStyle(),this.setPattern(),this.elementsForm.forEach((e=>e.addEventListener("change",this.checkIt.bind(this)))),this.form.addEventListener("submit",(t=>{if(this.elementsForm.forEach((e=>this.checkIt({target:e}))),this.error.size)return t.preventDefault(),void(e=!0);e=!1,this.elementsForm.forEach((e=>e.classList.remove("success")))}))}isValid(e){const t={notEmpty:e=>""!==e.value.trim(),pattern:(e,t)=>t.test(e.value)};if(!this.method)return console.warn("Передайте методы"),!0;{const n=this.method[e.id];if(n)return n.every((n=>t[n[0]](e,this.pattern[n[1]])))}}checkIt(e){const t=e.target;this.isValid(t)?(this.showSuccess(t),this.error.delete(t)):(this.showError(t),this.error.add(t))}showError(e){if(e.classList.remove("success"),e.classList.add("error"),e.nextElementSibling&&e.nextElementSibling.classList.contains("validator-error"))return;const t=document.createElement("div");t.textContent="Ошибка в этом поле",t.classList.add("validator-error"),e.insertAdjacentElement("afterend",t)}showSuccess(e){e.classList.remove("error"),e.classList.add("success"),e.nextElementSibling&&e.nextElementSibling.classList.contains("validator-error")&&e.nextElementSibling.remove()}applyStyle(){const e=document.createElement("style");e.textContent="\n        input.success {\n            border: 2px solid green !important;\n        }\n        input.error {\n            border: 2px solid red !important;\n        }\n        .validator-error {\n            font-size: 14px !important;\n            color: red !important;\n            font-family: sans-serif !important;\n        }\n        ",document.head.appendChild(e)}setPattern(){this.pattern.phone||(this.pattern.phone=/^\+?[78]([-()]*\d){10}$/),this.pattern.email||(this.pattern.email=/^\w+@+\w+\.\w{2,}$/)}}const n=new t({selector:"#form1",pattern:{name:/[A-Za-zА-Яа-яЁё]{2,}/,phone:/^((8|\+7)[- ]?)?(\(?\d{3}\)?[- ]?)?[\d\- ]{7,16}$/},method:{"form1-name":[["notEmpty"],["pattern","name"]],"form1-phone":[["notEmpty"],["pattern","phone"]]}}),o=new t({selector:"#form2",pattern:{name:/[A-Za-zА-Яа-яЁё]{2,}/,phone:/^((8|\+7)[- ]?)?(\(?\d{3}\)?[- ]?)?[\d\- ]{7,16}$/},method:{"form2-name":[["notEmpty"],["pattern","name"]],"form2-phone":[["notEmpty"],["pattern","phone"]]}});n.init(),o.init();const r=t=>{[...t.elements].filter((e=>"button"!==e.tagName.toLowerCase()&&"button"!==e.type)).forEach((e=>{e.addEventListener("input",(()=>{"fio"===e.name?e.value=e.value.replace(/[^а-яё a-z]/gi,""):"phone"===e.name&&(e.value=e.value.replace(/[^0-9()+-]/,""))}))}));const n=document.createElement("div");n.style.cssText="font-size: 1.5rem; color: #000 !important;",t.addEventListener("submit",(o=>{if(o.preventDefault(),!e){t.querySelector("button").disabled="true",t.appendChild(n),n.textContent="Загрузка...";const e=new FormData(t),o={};for(const t of e.entries())o[t[0]]=t[1];(e=>fetch("./server.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}))(o).then((e=>{if(200!==e.status)throw new Error("Status network not 200");n.textContent="Спасибо! Мы скоро с вами свяжимся!",setTimeout((()=>{n.remove(),t.querySelector("button").removeAttribute("disabled")}),3e3),t.reset()})).catch((e=>{n.textContent="Что то пошло не так...",setTimeout((()=>{n.remove(),t.querySelector("button").removeAttribute("disabled")}),3e3),t.reset()}))}}))},s=function(e,t){let n,o,r,s;function c(e){return void 0===e.toString()[1]?"0"+e:e}function a(){const t=function(){const t=(new Date(e).getTime()-(new Date).getTime())/1e3,n=Math.floor(t%60),o=Math.floor(t/60%60),r=Math.floor(t/60/60)%24;return{timeRemaining:t,days:Math.floor(t/60/60/24),hours:r,minutes:o,seconds:n}}();t.timeRemaining<0?(n.textContent="00",o.textContent="00",r.textContent="00",s.textContent="00"):(n.textContent=c(t.days),o.textContent=c(t.hours),r.textContent=c(t.minutes),s.textContent=c(t.seconds))}t?(n=document.querySelector(".count_1>span"),o=document.querySelector(".count_2>span"),r=document.querySelector(".count_3>span"),s=document.querySelector(".count_4>span")):(n=document.querySelectorAll(".count_1>span")[1],o=document.querySelectorAll(".count_2>span")[1],r=document.querySelectorAll(".count_3>span")[1],s=document.querySelectorAll(".count_4>span")[1]),a(),setInterval(a,1e3)};document.addEventListener("DOMContentLoaded",(()=>{(()=>{const e=document.querySelector(".button"),t=document.querySelector(".overlay"),n=document.querySelector(".header-modal");document.body.addEventListener("click",(o=>{const r=o.target;r.classList.contains("header-modal__close")?(o.preventDefault(),n.style.display="none",t.style.display="none"):r.closest(".button")===e&&(n.style.display="block",t.style.display="block")}))})(),document.addEventListener("scroll",(()=>{const e=document.getElementById("offer").getBoundingClientRect().bottom;document.querySelector(".smooth-scroll").style.display=e<0?"block":"none"})),document.body.addEventListener("click",(e=>{const t=e.target,n=document.getElementById("header").getBoundingClientRect().top;t.closest(".smooth-scroll")===document.querySelector(".smooth-scroll")&&window.scrollBy({top:n,behavior:"smooth"})})),(()=>{const e=document.querySelector(".overlay"),t=document.querySelector(".services-modal");document.body.addEventListener("click",(n=>{const o=n.target;o.classList.contains("services-modal__close")?(n.preventDefault(),t.style.display="none",e.style.display="none"):null!==o.closest(".service-button")&&o.closest(".service-button").classList.contains("service-button")&&(t.style.display="block",e.style.display="block")}))})(),r(document.querySelector("#form1")),r(document.querySelector("#form2"));const e=new Date;s(`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()+2}`,!0),s(`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()+2}`,!1)}))})();